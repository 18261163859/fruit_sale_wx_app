<!--pages/ship-detail/ship-detail.wxml-->
<view class="container">
  <view wx:if="{{order}}" class="content">
    <!-- 订单信息 -->
    <view class="order-section">
      <view class="section-title">订单信息</view>
      <view class="order-info">
        <view class="info-row">
          <text class="label">订单号:</text>
          <text class="value">{{order.orderNo}}</text>
        </view>
        <view class="info-row">
          <text class="label">下单时间:</text>
          <text class="value">{{order.createTime}}</text>
        </view>
        <view class="info-row">
          <text class="label">订单金额:</text>
          <text class="value amount">¥{{order.actualAmount}}</text>
        </view>
      </view>
    </view>

    <!-- 收货人信息 -->
    <view class="receiver-section">
      <view class="section-title">收货信息</view>
      <view class="receiver-content">
        <view class="receiver-row">
          <text class="receiver-name">{{order.receiverName}}</text>
          <text class="receiver-phone">{{order.receiverPhone}}</text>
        </view>
        <view class="receiver-address">
          {{order.receiverProvince}} {{order.receiverCity}} {{order.receiverDistrict}} {{order.receiverAddress}}
        </view>
      </view>
    </view>

    <!-- 商品列表 -->
    <view class="products-section">
      <view class="section-title">商品清单</view>
      <view class="products-list">
        <view
          wx:for="{{order.items}}"
          wx:key="id"
          class="product-item"
        >
          <image class="product-image" src="{{item.productImage}}" mode="aspectFill" />
          <view class="product-info">
            <text class="product-name">{{item.productName}}</text>
            <text class="product-spec" wx:if="{{item.specName}}">{{item.specName}}</text>
            <view class="quantity-row">
              <text class="price">¥{{item.productPrice}}</text>
              <text class="quantity">x{{item.quantity}}</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- 发货信息表单 -->
    <view class="ship-form-section">
      <view class="section-title">填写发货信息</view>

      <!-- 物流公司 -->
      <view class="form-item">
        <text class="form-label">物流公司 <text class="required">*</text></text>
        <picker class="form-picker" bindchange="selectLogistics" value="{{logisticsIndex}}" range="{{logisticsList}}">
          <view class="picker-value">
            {{logisticsList[logisticsIndex]}}
            <text class="arrow">›</text>
          </view>
        </picker>
      </view>

      <!-- 物流单号 -->
      <view class="form-item">
        <text class="form-label">物流单号 <text class="required">*</text></text>
        <input
          class="form-input"
          placeholder="请输入物流单号"
          value="{{trackingNumber}}"
          bindinput="onTrackingNumberInput"
        />
      </view>

      <!-- 发货照片 -->
      <view class="form-item photo-item">
        <text class="form-label">发货照片</text>
        <view class="photo-upload-area">
          <!-- 照片1 -->
          <view class="upload-box">
            <image wx:if="{{shipPhoto1}}" class="uploaded-image" src="{{shipPhoto1}}" mode="aspectFill" />
            <view wx:else class="upload-placeholder" bindtap="uploadPhoto1">
              <text class="upload-icon">+</text>
              <text class="upload-text">照片1</text>
            </view>
            <view wx:if="{{shipPhoto1}}" class="delete-btn" bindtap="deletePhoto" data-field="shipPhoto1">×</view>
          </view>

          <!-- 照片2 -->
          <view class="upload-box">
            <image wx:if="{{shipPhoto2}}" class="uploaded-image" src="{{shipPhoto2}}" mode="aspectFill" />
            <view wx:else class="upload-placeholder" bindtap="uploadPhoto2">
              <text class="upload-icon">+</text>
              <text class="upload-text">照片2</text>
            </view>
            <view wx:if="{{shipPhoto2}}" class="delete-btn" bindtap="deletePhoto" data-field="shipPhoto2">×</view>
          </view>
        </view>
      </view>

      <!-- 备注 -->
      <view class="form-item">
        <text class="form-label">备注</text>
        <textarea
          class="form-textarea"
          placeholder="选填，如发货时间、注意事项等"
          maxlength="200"
          value="{{remark}}"
          bindinput="onRemarkInput"
        />
      </view>
    </view>

    <!-- 底部提交按钮 -->
    <view class="footer-actions">
      <button class="submit-btn" bindtap="submitShip" disabled="{{loading}}">
        {{loading ? '提交中...' : '确认发货'}}
      </button>
    </view>
  </view>
</view>

<!--pages/cart/cart.wxml-->
<view class="container">
  <view wx:if="{{cartList.length > 0}}" class="cart-content">
    <!-- å…¨é€‰æ  -->
    <view class="select-all-bar">
      <label class="checkbox-wrapper">
        <checkbox-group bindchange="onSelectAll">
          <checkbox value="all" checked="{{isAllSelected}}" color="#1989fa"/>
        </checkbox-group>
        <text class="select-all-text">å…¨é€‰</text>
      </label>
    </view>

    <!-- è´­ç‰©è½¦åˆ—è¡¨ -->
    <view class="cart-list">
      <view wx:for="{{cartList}}" wx:key="id" class="cart-item">
        <!-- é€‰æ‹©æ¡† -->
        <label class="item-checkbox">
          <checkbox-group bindchange="onSelectItem" data-id="{{item.id}}">
            <checkbox value="{{item.id}}" checked="{{item.selected}}" color="#1989fa"/>
          </checkbox-group>
        </label>

        <view class="item-info" bindtap="goToProductDetail" data-id="{{item.productId}}">
          <image class="item-image" src="{{item.productImage}}" mode="aspectFill"></image>
          <view class="item-detail">
            <text class="item-name">{{item.productName}}</text>
            <text wx:if="{{item.specName}}" class="item-spec">è§„æ ¼: {{item.specName}}</text>
            <view class="item-bottom">
              <view class="price-info">
                <!-- ä¼šå‘˜ç”¨æˆ·æ˜¾ç¤ºä¼šå‘˜ä»·ä¸ºä¸»ä»·æ ¼ -->
                <block wx:if="{{isVip && item.vipPrice && item.vipPrice < item.price}}">
                  <text class="item-price">Â¥{{item.vipPrice}}</text>
                  <text class="item-original-price">Â¥{{item.price}}</text>
                  <text class="vip-badge">ä¼šå‘˜ä»·</text>
                </block>
                <!-- éä¼šå‘˜æˆ–æ— ä¼šå‘˜ä»·æ—¶æ˜¾ç¤ºæ™®é€šä»·æ ¼ -->
                <block wx:else>
                  <text class="item-price">Â¥{{item.price}}</text>
                </block>
              </view>
              <view class="item-actions">
                <view class="quantity-btn" catchtap="decreaseQuantity" data-id="{{item.id}}">-</view>
                <text class="quantity">{{item.quantity}}</text>
                <view class="quantity-btn" catchtap="increaseQuantity" data-id="{{item.id}}">+</view>
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <view wx:else class="empty-cart">
    <view class="empty-icon">ğŸ›’</view>
    <text class="empty-text">è´­ç‰©è½¦æ˜¯ç©ºçš„</text>
    <button class="go-shopping-btn" bindtap="goToIndex">å»é€›é€›</button>
  </view>

  <view wx:if="{{cartList.length > 0}}" class="cart-footer">
    <label class="footer-checkbox">
      <checkbox-group bindchange="onSelectAll">
        <checkbox value="all" checked="{{isAllSelected}}" color="#1989fa"/>
      </checkbox-group>
      <text class="select-text">å…¨é€‰</text>
    </label>

    <view class="footer-right">
      <view class="total-info">
        <text class="total-label">åˆè®¡ï¼š</text>
        <text class="total-price">Â¥{{totalPrice}}</text>
        <text class="selected-count">(å·²é€‰{{selectedCount}}ä»¶)</text>
      </view>
      <button class="checkout-btn" bindtap="goToCheckout" disabled="{{selectedCount === 0}}">
        å»ç»“ç®—{{selectedCount > 0 ? '(' + selectedCount + ')' : ''}}
      </button>
    </view>
  </view>
</view>
